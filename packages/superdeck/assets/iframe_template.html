<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iframe template</title>
    <style>
        /* CSS_PLACEHOLDER */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
     <script>
        // Function to load URL into iframe
        function loadURL(url) {
            document.getElementById('content-frame').src = url;
        }

        
        

        // Function to safely execute code in the iframe
        function executeInIframe(code) {
            return new Promise((resolve, reject) => {
                const iframe = document.getElementById('content-frame');
                if (!iframe) {
                    reject('Iframe not found');
                    return;
                }

                // Ensure the iframe is fully loaded
                if (iframe.contentWindow.document.readyState === 'complete') {
                    try {
                        const result = iframe.contentWindow.eval(code);
                        resolve(result);
                    } catch (error) {
                        reject(error);
                    }
                } else {
                    iframe.onload = () => {
                        try {
                            const result = iframe.contentWindow.eval(code);
                            resolve(result);
                        } catch (error) {
                            reject(error);
                        }
                    };
                }
            });
        }


        // Function to clear the DartPad editor
        function clearDartPadEditor() {
            return executeInIframe(`
                var editor = document.querySelector('.CodeMirror')?.CodeMirror;
                if (!editor) return;
                editor.setValue('');
                editor.setCursor({line: 0, ch: 0});
                editor.focus();
                console.log('DartPad editor cleared!');
            `);
        }

        // Function to add content to the DartPad editor
        function addToDartPadEditor(content) {
            return executeInIframe(`
                var editor = document.querySelector('.CodeMirror')?.CodeMirror;
                if (!editor) return;
                var currentContent = editor.getValue();
                var newContent = currentContent ? currentContent + '\\n' + ${JSON.stringify(content)} : ${JSON.stringify(content)};
                editor.setValue(newContent);
                editor.setCursor(editor.lineCount(), 0);
                editor.focus();
                console.log('Content added to DartPad editor!');
            `);
        }

        // Function to set content in the DartPad editor
        function setDartPadEditorContent(content) {
            return executeInIframe(`
                var editor = document.querySelector('.CodeMirror')?.CodeMirror;
                if (!editor) return;
                editor.setValue(${JSON.stringify(content)});
                editor.setCursor(editor.lineCount(), 0);
                editor.focus();
                console.log('DartPad editor content set!');
            `);
        }
    </script>
</head>
<body>
    <iframe id="content-frame" src="https://dartpad.dev"></iframe>
   
</body>
</html>